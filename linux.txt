CREATE TABLE pracownik(id_pracownika INT PRIMARY KEY, imie VARCHAR(40) NOT NULL, nazwisko VARCHAR(50) NOT NULL, zarobki DOUBLE(10,2) DEFAULT 4000, data_urodzenia DATE NOT NULL, stanowisko ENUM('manager','kierownik','sprzedawca','kasjer'));

INSERT INTO pracownik VALUES(1, 'Jan','Kowalski',3000, '1999-01-01', 'kasjer');

CREATE TABLE projekt(id_projektu INT PRIMARY KEY, nazwa VARCHAR(40), id_pracownika INT, FOREIGN KEY (id_pracownika) REFERENCES pracownik(id_pracownika));

UPDATE postac(1, , , ,)

DESC postac;
SELECT wiek FROM postac;
SELECT nazwa FROM postac;

CREATE TABLE postac(id_postaci INT PRIMARY KEY, nazwa VARCHAR(40) NOT NULL, rodzaj ENUM('wiking','ptak','kobieta'), data_ur DATE NOT NULL, wiek INT UNSIGNED);

CREATE TABLE walizka(id_walizki INT PRIMARY KEY AUTO_INCREMENT, pojemnosc ININSERT INTO izba VALUES('1','spizarnia','1','1','czarny');
 
CREATE TABLE izba(adres_budynku VARCHAR(40) PRIMARY KEY, nazwa_izby VARCHAR(40), metraz INT UNSIGNED, wlasciciel INT, FOREIGN KEY(wlasciciel) REFERENCES
postac(id_postaci));

INSERT INTO izba VALUES('1','spizarnia','1','1','czarny');

CREATE TABLE przetwory(id_przetworu INT PRIMARY KEY, rok_produkcji INT, id_wykonawcy INT, FOREIGN KEY(id_wykonawcy) REFERENCES postac(id_postaci), zawartosc VARCHAR(40), dodatek VARCHAR(40), id_konsumenta INT, FOREIGN KEY(id_konsumenta) REFERENCES postac(id_postaci));

INSERT INTO przetwory VALUES(1, 1654, '1', '', 'bigos_z_papryczka_chil', '1');

CREATE TABLE statek(nazwa_statku VARCHAR(40) PRIMARY KEY, rodzaj_statku ENUM('pasazerski','towarowy'), data_wodowania DATE, max_ladownosc INT UNSIGNED);

SHOW CREATE TABLE walizka;

ALTER TABLE walizka DROP FOREIGN KEY ifbk_1_walizka;

ALTER TABLE postac ADD funkcja VARCHAR(40);

UPDATE postac
    -> SET
    -> funkcja = 'kapitan'
    -> WHERE id_postaci = 2;

 INSERT INTO postac VALUES(8, 'WikingJeden','wiking','400-01-01',38, '', '');

DROP TABLE izba;

ALTER TABLE postac ADD statek VARCHAR(40);

ALTER TABLE postac ADD CONSTRAINT statek FOREIGN KEY(statek) REFERENCES statek(nazwa_statku);

CREATE TABLE Marynarz(id_postaci INT PRIMARY KEY, nazwa VARCHAR(40) NOT NULL, rodzaj ENUM('wiking','ptak','kobieta','syrena','waz'), data_urodzenia DATE, wiek INT, funkcja VARCHAR(40), statek VARCHAR(40), FOREIGN KEY(statek) REFERENCES statek(nazwa_statku), pesel VARCHAR(11));

CREATE TABLE marynarz AS SELECT * FROM postac WHERE rodzaj='wiking' OR nazwa='Drozd';

CREATE TABLE marynarz LIKE postac;

ALTER TABLE marynarz ADD PRIMARY KEY(id_postaci);

ALTER TABLE marynarz ADD FOREIGN KEY(statek) REFERENCES statek(nazwa_statku);

UPDATE postac SET statek = NULL WHERE id_postaci > 0;

DELETE FROM postac WHERE id_postaci = 6;

DELETE FROM statek WHERE nazwa_statku = 'titanic';

CREATE TABLE kreatura(idKreatury INT PRIMARY KEY NOT NULL, nazwa VARCHAR(30) DEFAULT NULL, rodzaj VARCHAR(30) DEFAULT NULL, dataUr DATE DEFAULT NULL, waga INT UNSIGNED DEFAULT NULL, udzwig INT UNSIGNED DEFAULT NULL);

INSERT INTO bogdanskis.kreatura (idKreatury, nazwa, rodzaj, dataUr, waga, udzwig) SELECT idKreatury,nazwa,rodzaj,dataUr,waga,udzwig FROM wikingowie.kreatura;

CREATE TABLE zwierz(id INT PRIMARY KEY AUTO_INCREMENT, nazwa VARCHAR(40), wiek INT);

DELETE FROM statek WHERE nazwa_statku = 'diadema';

INSERT INTO zwierz VALUES(1, Drozd, 1);

INSERT INTO zwierz VALUES(2, 'Loco', 1);

ALTER TABLE postac DROP FOREIGN KEY statek;

CREATE TABLE kreatura(idKreatury INT PRIMARY KEY, nazwa VARCHAR(100), rodzaj ENUM('wiking','ryba','waz','ptak','malpa','wiedzma'), dataUr DATE, waga INT, udzwig INT);

INSERT INTO bogdanskis.kreatura (idKreatury, nazwa, rodzaj, dataUr, waga, udzwig) SELECT idKreatury,nazwa,rodzaj,dataUr,waga,udzwig FROM wikingowie.kreatura;

CREATE TABLE zasob(id_Zasobu INT NOT NULL PRIMARY KEY AUTO_INCREMENT, nazwa VARCHAR(50) DEFAULT NULL, waga FLOAT(6,2)DEFAULT NULL, ilosc INT UNSIGNED DEFAULT NULL, dataPozyskania DATE DEFAULT NULL, rodzaj VARCHAR(50) DEFAULT NULL);

INSERT INTO bogdanskis.zasob (id_Zasobu, nazwa, waga, ilosc, dataPozyskania, rodzaj) SELECT idZasobu,nazwa,waga,ilosc,dataPozyskania,rodzaj FROM wikingowie.zasob;

CREATE TABLE ekwipunek(idEkwipunku INT NOT NULL AUTO_INCREMENT PRIMARY KEY, idKreatury INT DEFAULT NULL, FOREIGN KEY (idKreatury) REFERENCES kreatura(idKreatury), idZasobu INT DEFAULT NULL, FOREIGN KEY (idZasobu) REFERENCES zasob(id_Zasobu), ilosc INT UNSIGNED DEFAULT NULL);

INSERT INTO bogdanskis.ekwipunek (idEkwipunku, idKreatury, idZasobu, ilosc) SELECT idEkwipunku,idKreatury,idZasobu,ilosc FROM wikingowie.ekwipunek;

SELECT * FROM zasob;

SELECT * FROM zasob WHERE rodzaj = 'jedzenie';

SELECT * FROM kreatura WHERE rodzaj !='wiedzma' HAVING udzwig>50;

SELECT * FROM zasob WHERE waga>2 AND waga<5;

SELECT * FROM zasob WHERE month(dataPozyskania)=7 OR month(dataPozyskania)=8;

SELECT CONCAT(nazwa,' ',rodzaj) FROM kreatura WHERE rodzaj LIKE 'wi%';

SELECT CONCAT(ilosc*waga) FROM zasob WHERE year(dataPozyskania)>=2000 AND year(dataPozyskania)<=2007;

SELECT nazwa,rodzaj FROM zasob WHERE nazwa LIKE 'Ba%' OR nazwa LIKE '%os' ORDER BY nazwa ASC;

SELECT AVG(waga) FROM kreatura WHERE rodzaj = 'wiking';

SELECT AVG(waga), COUNT(nazwa) FROM kreatura;

SELECT kreatura.nazwa, zasob.nazwa FROM kreatura JOIN ekwipunek ON kreatura.idKreatury = ekwipunek.idKreatury JOIN zasob ON ekwipunek.idZasobu = zasob.id_Zasobu WHERE year(dataUR)>1669 AND year(dataUr)<1680 AND kreatura.rodzaj = 'wiking';

SELECT kreatura.nazwa FROM kreatura JOIN ekwipunek ON kreatura.idKreatury = ekwipunek.idKreatury JOIN zasob ON ekwipunek.idZasobu = zasob.id_Zasobu WHERE zasob.rodzaj = 'jedzenie' ORDER BY 'kreatura.wiek' ASC LIMIT 5;

SELECT a.nazwa, b.nazwa from kreatura a, kreatura b WHERE a.idKreatury + 5 = b.idKreatury;

SELECT kreatura.rodzaj, zasob.waga AVG FROM kreatura JOIN ekwipunek ON kreatura.idKreatury = ekwipunek.idKreatury JOIN zasob ON ekwipunek.idZasobu = zasob.id_Zasobu WHERE kreatura.rodzaj != 'malpa' AND kreatura.rodzaj != 'waz' AND ekwipunek.ilosc < 30;


CREATE TABLE uczestnicy (like wikingowie.uczestnicy);

INSERT INTO bogdanskis.ekwipunek (id_wyprawy, id_uczestnika) SELECT id_wyprawy, id_uczestnika FROM wikingowie.uczestnicy;

CREATE TABLE wyprawa (like wikingowie.wyprawa);

INSERT INTO bogdanskis.uczestnicy (id_wyprawy, id_uczestnika) SELECT id_wyprawy, id_uczestnika FROM wikingowie.uczestnicy;

CREATE TABLE sektor (like wikingowie.sektor);

CREATE TABLE etapy_wyprawy (like wikingowie.etapy_wyprawy);

INSERT INTO bogdanskis.sektor (id_sektora, nazwa, wspolrzedna_x, wspolrzedna_y) SELECT id_sektora, nazwa, wspolrzedna_x, wspolrzedna_y FROM wikingowie.sektor;

INSERT INTO bogdanskis.etapy_wyprawy (idEtapu, idWyprawy, sektor, kolejnosc, dziennik) SELECT idEtapu, idWyprawy, sektor, kolejnosc, dziennik FROM wikingowie.etapy_wyprawy;

SELECT wyprawa.nazwa, SUM(ilosc) FROM wyprawa JOIN uczestnicy ON wyprawa.id_wyprawy=uczestnicy.id_wyprawy JOIN ekwipunek ON uczestnicy.id_uczestnika=ekwipunek.idKreatury GROUP BY wyprawa.nazwa;

SELECT wyprawa.nazwa, COUNT(uczestnicy.id_uczestnika) AS uczestnicy_liczba, GROUP_CONCAT(kreatura.nazwa) AS uczestnicy_nazwy FROM wyprawa JOIN uczestnicy ON wyprawa.id_wyprawy=uczestnicy.id_wyprawy JOIN kreatura ON uczestnicy.id_uczestnika=kreatura.idKreatury GROUP BY wyprawa.nazwa;

SELECT wyprawa.nazwa, sektor.nazwa, kreatura.nazwa  FROM wyprawa JOIN etapy_wyprawy ON wyprawa.id_wyprawy=etapy_wyprawy.idWyprawy JOIN sektor ON etapy_wyprawy.sektor=sektor.id_sektora JOIN kreatura ON wyprawa.kierownik=kreatura.idKreatury ORDER BY wyprawa.data_rozpoczecia, etapy_wyprawy.kolejnosc DESC;
